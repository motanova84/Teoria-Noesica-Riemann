name: ğŸŒŠ Resonancia Viva CI - fâ‚€ = 141.7001 Hz

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '17 14 * * *'

jobs:
  test-resonance:
    name: ğŸµ Test Frecuencia de Resonancia
    runs-on: ubuntu-latest
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4

    - name: ğŸ§ª VerificaciÃ³n directa de primo y frecuencia con trazas
      run: |
        python3 -c '
def es_primo(n):
    print(f"Verificando si {n} es primo...")
    if n <= 1:
        return False
    for i in range(2, int(n ** 0.5) + 1):
        if n % i == 0:
            print(f"Divisible por {i} â†’ NO primo")
            return False
    return True

p = 1417
print("Comprobando primo...")

if not es_primo(p):
    print("âŒ 1417 no es primo")
    exit(1)

print("Comprobando frecuencia...")
if abs(p / 10 - 141.7001) >= 1e-10:
    print(f"âŒ Frecuencia incorrecta: {p / 10}")
    exit(1)

print(f"âœ… {p} es primo y fâ‚€ = 141.7001 Hz verificados")
'

  deploy-docs:
    name: ğŸ“˜ Deploy DocumentaciÃ³n MkDocs
    runs-on: ubuntu-latest
    needs: test-resonance
    if: github.ref == 'refs/heads/main'
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4

    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Instalar dependencias de documentaciÃ³n
      run: |
        pip install mkdocs mkdocs-material

    - name: ğŸ—ï¸ Build Docs
      run: |
        mkdocs build --clean

    - name: ğŸš€ Deploy GitHub Pages
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./site

  resonance-analysis:
    name: ğŸ”¬ AnÃ¡lisis Espectral NoÃ©sico
    runs-on: ubuntu-latest
    needs: test-resonance
    steps:
    - name: ğŸ“¥ Checkout
      uses: actions/checkout@v4

    - name: ğŸ Setup Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.10'

    - name: ğŸ“¦ Instalar librerÃ­as
      run: |
        pip install numpy matplotlib

    - name: ğŸ”¬ Ejecutar anÃ¡lisis y graficar
      run: |
        python3 -c '
import numpy as np
import matplotlib
matplotlib.use("Agg")
import matplotlib.pyplot as plt

# SimulaciÃ³n bÃ¡sica del anÃ¡lisis de resonancia
N_values = [100, 500, 1000, 2000, 5000]
frequencies = [141.6 + (0.1*np.log(n)) for n in N_values]

plt.figure(figsize=(10, 6))
plt.semilogx(N_values, frequencies, marker="o")
plt.axhline(141.7001, color="red", linestyle="--", label="fâ‚€ = 141.7001 Hz")
plt.title("ğŸµ Convergencia a fâ‚€")
plt.xlabel("N")
plt.ylabel("Frecuencia (Hz)")
plt.grid(True)
plt.legend()
plt.tight_layout()
plt.savefig("resonance_convergence.png")
print("ğŸ“Š GrÃ¡fica generada")
'

    - name: ğŸ“„ Subir grÃ¡fica como artefacto
      uses: actions/upload-artifact@v4
      with:
        name: resonance-convergence
        path: resonance_convergence.png

  notify:
    name: ğŸ’Œ NotificaciÃ³n simbÃ³lica
    runs-on: ubuntu-latest
    needs: [test-resonance, deploy-docs, resonance-analysis]
    if: always()
    steps:
    - name: âœ¨ Estado final
      run: |
        echo "âœ… Flujo completo ejecutado:"
        echo "   - Test primo y frecuencia"
        echo "   - DocumentaciÃ³n desplegada"
        echo "   - AnÃ¡lisis espectral completo"
        echo ""
        echo "ğŸŒŠ Campo NoÄ“sico operativo âˆÂ³"
